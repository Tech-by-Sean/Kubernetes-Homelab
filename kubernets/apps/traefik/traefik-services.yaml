# traefik-services.yaml

# -------------------------------------
# Service A: Traefik on the Media Subnet VIP (192.168.3.220)
# -------------------------------------
apiVersion: v1
kind: Service
metadata:
  name: traefik-media-ingress
  namespace: traefik
  annotations:
    # KEY: Uses the 192.168.3.x range
    metallb.io/address-pool: media-pool
spec:
  type: LoadBalancer
  # Selector must match the labels of the Traefik deployment created by Helm
  selector:
    app.kubernetes.io/name: traefik
    app.kubernetes.io/instance: traefik
  ports:
    - name: web
      port: 80
      targetPort: web
    - name: websecure
      port: 443
      targetPort: websecure

---
# -------------------------------------
# Service B: Traefik on the Server Subnet VIP (10.10.5.220)
# -------------------------------------
apiVersion: v1
kind: Service
metadata:
  name: traefik-server-ingress
  namespace: traefik
  annotations:
    # KEY: Uses the 10.10.5.x range
    metallb.io/address-pool: server-pool
spec:
  type: LoadBalancer
  # Selector must match the labels of the Traefik deployment created by Helm
  selector:
    app.kubernetes.io/name: traefik
    app.kubernetes.io/instance: traefik
  ports:
    - name: web
      port: 80
      targetPort: web
    - name: websecure
      port: 443
      targetPort: websecure